#!/bin/bash
BACKUP_DIR="{{ backup_dir }}"
LOG_FILE="/var/log/backup-menu.log"

mkdir -p "$BACKUP_DIR"

TIMESTAMP="$(date +%Y-%m-%d_%H-%M-%S)"
FILE="$BACKUP_DIR/menu_${TIMESTAMP}.json"

if curl -s http://localhost:8080/menu > "$FILE"; then
  echo "$(date): Backup OK -> $FILE" >> "$LOG_FILE"
else
  echo "$(date): Backup FAILED" >> "$LOG_FILE"
  rm -f "$FILE"
fi
